# Лабораторные работы по компьютерному зрению

Этот репозиторий содержит две лабораторные работы по обработке изображений с использованием Python, OpenCV, и связанных библиотек.

## Содержание

- **Лабораторная работа №1**: Базовые методы обработки изображений
  - Предварительная обработка (преобразование в серый, бинаризация, работа с гистограммой)
  - Операции свёртки (размытие, повышение чёткости, выделение краёв)
  - Геометрические преобразования (сдвиг, поворот)

- **Лабораторная работа №2**: Выделение признаков изображений
  - Обнаружение прямых линий (преобразование Хафа)
  - Обнаружение окружностей (преобразование Хафа)
  - Сегментация по текстуре (алгоритм роста регионов с LBP)

## Структура проекта

```
CV-lab-1/
├── lab1_app.py          # GUI приложение для лабораторной работы №1
├── lab2_app.py          # GUI приложение для лабораторной работы №2
├── lab1_report.ipynb    # Отчёт по лабораторной работе №1 (Jupyter Notebook)
├── lab2_report.ipynb    # Отчёт по лабораторной работе №2 (Jupyter Notebook)
├── requirements.txt     # Зависимости проекта
├── README.md           # Этот файл
└── test_images/        # Папка для тестовых изображений (создаётся автоматически)
```

## Требования к системе

- **Python**: 3.8 или выше
- **Операционная система**: Windows, macOS, или Linux
- **Дополнительно**: Для GUI приложений требуется графическая среда

## Установка

### Быстрая установка (рекомендуется)

Используйте автоматический скрипт установки:

**Для macOS/Linux:**
```bash
chmod +x setup_environment.sh
./setup_environment.sh
```

**Для Windows:**
```bash
setup_environment.bat
```

Скрипт автоматически:
- Создаст виртуальное окружение
- Установит все зависимости
- Зарегистрирует kernel для Jupyter
- Создаст папку для тестовых изображений

### Ручная установка

Если предпочитаете устанавливать вручную:

#### 1. Клонирование репозитория

```bash
git clone <url-репозитория>
cd CV-lab-1
```

#### 2. Создание виртуального окружения (ОБЯЗАТЕЛЬНО!)

```bash
# Для macOS/Linux
python3 -m venv venv
source venv/bin/activate

# Для Windows
python -m venv venv
venv\Scripts\activate
```

#### 3. Установка зависимостей

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

#### 4. Регистрация виртуального окружения в Jupyter (КРИТИЧЕСКИ ВАЖНО!)

Чтобы Jupyter Notebook мог использовать ваше виртуальное окружение:

```bash
# Убедитесь, что виртуальное окружение активировано!
python -m ipykernel install --user --name=cv-lab-env --display-name="Python (CV Labs)"
```

**Проверка:** После этого при запуске Jupyter вы должны увидеть kernel "Python (CV Labs)" в списке доступных kernel'ов.

## Версии библиотек

| Библиотека | Версия | Назначение |
|-----------|---------|-----------|
| opencv-python | 4.8.1.78 | Основная библиотека для обработки изображений |
| numpy | 1.24.3 | Вычисления с массивами |
| matplotlib | 3.7.2 | Визуализация результатов |
| PyQt5 | 5.15.9 | Графический интерфейс пользователя |
| scikit-image | 0.21.0 | Дополнительные алгоритмы обработки изображений (LBP) |
| jupyter | 1.0.0 | Для работы с notebook-отчётами |

*Примечание: указаны рекомендуемые версии, работают также и более новые версии.*

## Использование

### Запуск GUI приложений

#### Лабораторная работа №1

```bash
python lab1_app.py
```

**Функциональность:**
1. Нажмите "Загрузить изображение" для выбора файла
2. Выберите нужную операцию из групп:
   - **a. Предварительная обработка**: преобразования цвета и гистограммы
   - **b. Операции свёртки**: фильтрация и выделение краёв
   - **c. Геометрические преобразования**: сдвиг и поворот
3. Результат отобразится справа

#### Лабораторная работа №2

```bash
python lab2_app.py
```

**Функциональность:**
1. Нажмите "Загрузить изображение" для выбора файла
2. Выберите операцию:
   - **a. Найти линии (Хаф)**: обнаружение прямых линий
   - **a. Найти окружности (Хаф)**: обнаружение окружностей
   - **c. Сегментация по текстуре**: кликните на изображении для выбора затравочной точки
3. Результат отобразится справа

**Примечание для сегментации**: после нажатия кнопки "Сегментация по текстуре" кликните мышью на области изображения, которую хотите сегментировать.

### Запуск Jupyter Notebook отчётов

#### Лабораторная работа №1

```bash
# Убедитесь, что виртуальное окружение активировано!
jupyter notebook lab1_report.ipynb
```

Или откройте в Jupyter Lab:

```bash
jupyter lab lab1_report.ipynb
```

#### Лабораторная работа №2

```bash
jupyter notebook lab2_report.ipynb
```

**ВАЖНО: Выбор правильного kernel:**
1. Откройте notebook
2. В верхнем меню выберите: `Kernel > Change Kernel > Python (CV Labs)`
3. Если "Python (CV Labs)" не отображается, выполните команду регистрации kernel из раздела установки

**В notebook:**
1. Убедитесь, что выбран правильный kernel (см. выше)
2. Выполните все ячейки последовательно: `Cell > Run All`
3. Поместите свои тестовые изображения в папку `test_images/` с именами `test1.jpg`, `test2.jpg`, `test3.jpg`
4. Если изображения не найдены, автоматически создадутся синтетические для демонстрации

## Тестовые изображения

Для полноценного тестирования рекомендуется использовать следующие типы изображений:

### Для лабораторной работы №1:
- **Изображение 1**: Фотография с хорошей детализацией (природа, архитектура)
- **Изображение 2**: Изображение с чёткими геометрическими объектами
- **Изображение 3**: Изображение с различными уровнями яркости

### Для лабораторной работы №2:
- **Изображение 1**: Изображение с прямыми линиями (здания, дороги, архитектура)
- **Изображение 2**: Изображение с круглыми объектами (монеты, тарелки, колёса)
- **Изображение 3**: Изображение с различными текстурами (ткань, дерево, кирпичная кладка)

Поддерживаемые форматы: `.jpg`, `.jpeg`, `.png`, `.bmp`

## Параметры алгоритмов

### Лабораторная работа №1

| Операция | Параметры |
|----------|-----------|
| Размытие по Гауссу | Размер ядра: 5×5 |
| Бинаризация (фикс. порог) | Порог: 127 |
| Циклический сдвиг | Сдвиг: 50 пикселей по X и Y |
| Поворот | Угол: 45° |

### Лабораторная работа №2

| Операция | Параметры |
|----------|-----------|
| Детектор Canny (для линий) | Нижний порог: 50, Верхний: 150 |
| Хаф для линий | Порог: 100, Мин. длина: 100, Макс. разрыв: 10 |
| Хаф для окружностей | Мин. расстояние: 30, Мин. радиус: 5, Макс. радиус: 300 |
| Сегментация LBP | Радиус: 1, Точки: 8, Размер патча: 9×9 |
| Пороги сегментации | Цвет: 40, Текстура: 0.5 (корреляция) |

*Примечание: параметры подобраны для большинства случаев, но могут быть изменены в исходном коде для специфических задач.*

## Известные проблемы и решения

### Проблема: "Qt platform plugin could not be initialized"

**Решение (macOS):**
```bash
pip uninstall PyQt5 PyQt5-sip
pip install PyQt5 PyQt5-sip
```

**Решение (Linux):**
```bash
sudo apt-get install python3-pyqt5
```

### Проблема: Jupyter Notebook не открывается

**Решение:**
```bash
pip install --upgrade jupyter notebook
jupyter notebook --version  # Проверить установку
```

### Проблема: В Jupyter не отображается kernel "Python (CV Labs)"

**Решение:**
```bash
# Убедитесь, что виртуальное окружение активировано
source venv/bin/activate  # macOS/Linux
# или
venv\Scripts\activate  # Windows

# Зарегистрируйте kernel заново
python -m ipykernel install --user --name=cv-lab-env --display-name="Python (CV Labs)"

# Проверьте список установленных kernel'ов
jupyter kernelspec list
```

### Проблема: Ошибка "ModuleNotFoundError" в Jupyter Notebook

**Причина:** Jupyter использует неправильный Python kernel (не из вашего виртуального окружения)

**Решение:**
1. В открытом notebook: `Kernel > Change Kernel > Python (CV Labs)`
2. Если kernel не отображается, выполните команду регистрации из раздела установки
3. Перезапустите Jupyter Notebook

### Проблема: Медленная работа сегментации

**Решение:**
- Используйте изображения меньшего размера (< 800×800 пикселей)
- В коде уже реализовано автоматическое масштабирование для больших изображений

### Проблема: Не находятся линии или окружности

**Решение:**
- Убедитесь, что изображение имеет достаточный контраст
- Попробуйте другое изображение с более чёткими объектами
- Измените параметры в исходном коде (пороги детектора Canny, параметры Хафа)

## Обоснование выбора технологий

### Python + OpenCV
- **OpenCV** - стандарт де-факто для компьютерного зрения
- Обширная документация и большое сообщество
- Высокая производительность благодаря реализации на C++
- Богатая функциональность из коробки

### NumPy
- Эффективная работа с многомерными массивами (изображениями)
- Оптимизированные математические операции
- Интеграция с OpenCV

### Matplotlib
- Простая и мощная визуализация
- Хорошая интеграция с Jupyter Notebook
- Поддержка различных форматов изображений

### PyQt5
- Кроссплатформенный GUI фреймворк
- Богатый набор виджетов
- Возможность создания профессиональных интерфейсов

### scikit-image
- Специализированные алгоритмы обработки изображений
- LBP (Local Binary Patterns) для анализа текстур
- Дополняет функциональность OpenCV

## Структура кода

### Лабораторная работа №1 (lab1_app.py)

```python
class ImageProcessorApp(QWidget):
    def __init__(self):
        # Инициализация GUI и переменных
        
    def load_image(self):
        # Загрузка изображения
        
    # Группа a: Предварительная обработка
    def convert_to_gray_avg(self): ...
    def convert_to_gray_standard(self): ...
    def binarize_threshold(self): ...
    def binarize_otsu(self): ...
    def equalize_histogram(self): ...
    def stretch_histogram(self): ...
    
    # Группа b: Операции свёртки
    def gaussian_blur(self): ...
    def sharpen_laplacian(self): ...
    def sobel_edges(self): ...
    
    # Группа c: Геометрические преобразования
    def cyclic_shift(self): ...
    def rotate_image(self): ...
```

### Лабораторная работа №2 (lab2_app.py)

```python
class ImageProcessorApp(QWidget):
    def __init__(self):
        # Инициализация GUI и переменных
        
    def load_image(self):
        # Загрузка изображения
        
    # Группа a: Преобразование Хафа
    def find_hough_lines(self): ...
    def find_hough_circles(self): ...
    
    # Группа c: Сегментация
    def start_texture_segmentation(self): ...
    def perform_region_growing(self, seed_x, seed_y): ...
```

## Авторство и лицензия

Этот проект создан в образовательных целях для курса по компьютерному зрению.

## Дополнительные ресурсы

- [Документация OpenCV](https://docs.opencv.org/)
- [Документация NumPy](https://numpy.org/doc/)
- [Документация Matplotlib](https://matplotlib.org/stable/contents.html)
- [Документация scikit-image](https://scikit-image.org/docs/stable/)

## Контакты и поддержка

При возникновении вопросов или проблем:
1. Проверьте раздел "Известные проблемы и решения"
2. Убедитесь, что все зависимости установлены корректно
3. Проверьте версии библиотек

---

**Дата последнего обновления**: Октябрь 2025

